@using MvcFlashMessages
@model emp_ferias.Models.IndexUserViewModel
@{
    ViewBag.Title = "Utilizadores - Gestor de Férias";
}

<div class="jumbotron">
    <div class="container-fluid body-content">
        <h1 id="icon">Utilizadores</h1>
        <p class="lead container body-content jumbotron-description"></p>
    </div>
</div>


<div class="content">
    <div class="col-md-@(Model.LoggedUser.RoleTests.IsAdmin ? "10" : "12")" style="padding-left: 0px; padding-right: 0px;">
        <ol class="breadcrumb">
            <li>@Html.ActionLink("Página Inicial", "Index", "Home")</li>
            <li class="active">Utilizadores</li>
        </ol>
    </div>
    @Html.RenderFlash()
    @if (Model.LoggedUser.RoleTests.IsAdmin)
    {
        <div class="col-md-2" id="create-new-button-wrapper">
            <button onclick="location.href='@Url.Action("Create", "User")';return false;" class="btn btn-round-default" id="create-user-button"><i class="fa fa-user-plus" aria-hidden="true"></i>&nbsp;Criar Utilizador</button>
        </div>
    }
    

    <table class="table table-hover" id="usersTable">
        <thead>
            <tr>
                <th>Função</th>
                <th>Nome de Utilizador</th>
                <th>GUID</th>
                <th>Email</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.UserList)
            {
                <tr class="bg-info">
                    <td style="color: @(item.Role == "Administrador" ? "#6f5499" : item.Role == "Moderador" ? "red" : "#777")">
                        <strong>@item.Role</strong>
                    </td>
                    <td>
                        @item.UserName
                    </td>
                    <td>
                        @item.Id
                    </td>
                    <td>
                        @item.Email
                    </td>
                    <td>
                        @((Model.LoggedUser.RoleTests.IsAdmin) || (Model.LoggedUser.RoleTests.IsMod && item.RoleTests.IsUser) ? Html.ActionLink("Editar", "Edit", new { id = item.Id }) : Html.Display(""))
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

@section scripts {
    <script>
        $('#usersTable').DataTable({
            "aoColumns": [
                null,
                null,
                { "bSortable": false },
                { "bSortable": false },
                { "bSortable": false }
            ],
            language: {
                "sProcessing": "A processar...",
                "sLengthMenu": "Mostrar _MENU_ registos",
                "sZeroRecords": "Não foram encontrados resultados",
                "sInfo": "Mostrando _START_ a _END_ de _TOTAL_ registos",
                "sInfoEmpty": "Mostrando 0 a 0 de 0 registos",
                "sInfoFiltered": "(filtrado de _MAX_ registos no total)",
                "sInfoPostFix": "",
                "sSearch": "Procurar:",
                "sUrl": "",
                "oPaginate": {
                    "sFirst": "Primeiro",
                    "sPrevious": "Anterior",
                    "sNext": "Seguinte",
                    "sLast": "Último"
                }
            }
        })
    </script>        
}
